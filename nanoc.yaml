text_extensions: [ 'atom', 'coffee', 'css', 'erb', 'haml', 'handlebars', 'hb', 'htm', 'html', 'js', 'less', 'markdown', 'md', 'ms', 'mustache', 'php', 'rb', 'rdoc', 'sass', 'scss', 'slim', 'tex', 'ttl', 'txt', 'xhtml', 'xml' ]

enable_output_diff: true

prune:
  auto_prune: true

data_sources:
  - type: filesystem
    content_dir: items

  - type: dependencies
    items_root: /_project

  - type: tags
    items_root: /_project

  - type: vocabularies
    items_root: /_project
    prefixes_used:
      standard:   [ cc, ctag, dc, foaf, owl, prov, rdf, rdfs, schema, sioc, skos, xhv ]
      business:   [ essglobal, fea, rov, vcard ]
      open_graph: [ article, og, profile ]
      document:   [ deo, doco, fabio ]
      instances:  [ dbo, dbr, yago ]
      technical:  [ deps, doap, vann, voaf, void ]
      pentandra:  [ pentandra, pentandra-blog, pentandra-website ]
      extra:      [ essglobal-activities, essglobal-legalform, essglobal-qualifiers, essglobal-typeoflabour, sioct, xsd ]

  - type: company
    company_metafile: 'etc/company.yaml'

  - type: filesystem
    items_root: /specifications
    content_dir: specifications/playground
    layouts_dir: specifications/layouts

checks: &checks
  internal_links:
    exclude: [ '^/blog/feed' ]

  external_links:
    exclude: [ 'example.org' ]

environments:
  default: &default
    base_url: &base_url "https://pentandra.com"

    erb:
      trim_mode: '>'

    kramdown:
      auto_ids: true
      auto_id_prefix: "sec:"
      auto_id_stripping: true
      toc_levels: 1..3
      syntax_highlighter: nil
      header_offset: 1

    geungle:
      live: false

    qrcode:
      size: 25
      module_size: 2
      color: "#544233"

    git:
      url: "https://github.com/pentandra/lifepreserver.git"
      browse_url: "https://github.com/pentandra/lifepreserver"
      tag_url: "https://github.com/pentandra/lifepreserver/releases/tag"
      version_history_url: "https://github.com/lifepreserver/commits/master"

    site: &site
      name: Pentandra
      motto: Breaking Research Barriers
      recent_thoughts_limit: 5
      generate_blogmeta: true
      base_url: *base_url
      images_url: /images
      search_url: /search

    blog: &blog
      title: The Pentandra Blog
      author_name: Pentandra
      author_uri: *base_url
      url: /blog
      tags_url: /tags
      archives_url: /archives
      authors_url: /authors
      feed_url: /blog/feed

    company:
      page_url: /company
      logo_uri: &logo_uri "https://pentandra.com/images/pentandra-logo.png"
      photo_uri: *logo_uri
      kind: org

  development:
    <<: *default

    site: # Simplify dependencies for quicker compilation during development
      <<: *site
      recent_thoughts_limit: 0
      generate_blogmeta: false

    context2pdf:
      debug: true
      trackers: [ 'graphics.locating' ]

    checks:
      <<: *checks
      internal_links:
        exclude: [ '^/blog/feed', '^/tags', '^/archives', '^/authors' ]

  production:
    <<: *default

    google_analytics:
      code: UA-26002603-1
      site: pentandra.com

    hypothesis: true
    production: true

deploy:
  public:
    kind: rsync
    dst: "pentandra.com:/srv/http/lifepreserver"
    options: [ '-gpPrtvz', '--delete-after' ]
  staging:
    kind: rsync
    dst: "vlad@rebikov.process.tree:/srv/http/lifepreserver"
    options: [ '-gpPrtvz', '--delete-after' ]
